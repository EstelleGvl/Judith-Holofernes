coord_flip()+
ggtitle("Glossed Bible by century and presence of blood")
ParisBible <- filter(mydata,  title %in% c("HistorienBible"))
ggplot(ParisBible, aes(century, fill = blood)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("HistorienBible by century and presence of blood")
ParisBible <- filter(mydata,  title %in% c("Parisian Bible"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Paris Bibles by century and aciton represented")
ParisBible <- filter(mydata,  title %in% c("Speculum humanae salvationis"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Speculum humanae salvationis by century and action represented")
ParisBible <- filter(mydata,  title %in% c("Histoire ancienne jusqu'a Cesar"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Histoire ancienne jusqu'a Cesar by century and action represented")
ParisBible <- filter(mydata,  title %in% c("Breviary"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Breviary by century and action represented")
ParisBible <- filter(mydata,  title %in% c("Speculum historiale"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Speculum historiale by century and action represented")
ParisBible <- filter(mydata,  title %in% c("Bible"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Bible by century and action represented")
ParisBible <- filter(mydata,  title %in% c("Glossed Bible"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Glossed Bible by century and action represented")
ParisBible <- filter(mydata,  title %in% c("HistorienBible"))
ggplot(ParisBible, aes(action, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("HistorienBible by century and action represented")
Historial <- filter(mydata,  title %in% c("Bible historiale"))
ggplot(Historial, aes(century, fill = title)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", vjust = 0.25, colour = "black") +
coord_flip()+
ggtitle("Distribution of Bibles historiales by century")
Spe_histo <- filter(mydata,  title %in% c("Speculum historiale"))
ggplot(Spe_histo, aes(century, fill = language)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Speculum historiale by century and language")
ggplot(mydata, aes(title, fill = language)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("All texts by language")
ggplot(mydata, aes(language, fill = blood)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of blood by language of the text")
ggplot(mydata, aes(language, fill = action)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Action by language")
dt <- mydata%>%
dplyr::group_by(language,  action)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= language, y = n,fill = action))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Action by language in percentages")
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(language,  blood)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= language, y = n,fill = blood))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Blood by language in percentages")
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(language,  holofernes_crowned)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= language, y = n,fill = holofernes_crowned))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Blood by language in percentages")
ggplotly(pl)
pl <- ggplot(mydata, aes(type, fill = century)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Illumination type by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(type,  century)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= type, y = n,fill = century))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + coord_flip()
pl <- pl  + ggtitle("Illumination type by century in percentages")
pl
ggplotly(pl)
pl <- ggplot(data = mydata, aes(x = factor(type),
y = prop.table(stat(count)),
fill = factor(century),
label = scales::percent(prop.table(stat(count))))) +
geom_bar(position = "dodge") +
geom_text(stat = 'count',
position = position_dodge(.9),
vjust = -0.5,
size = 3) +
scale_y_continuous(labels = scales::percent) +
labs(x = 'type', y = 'pct', fill = 'century') +
ggtitle("Illumination type by century in percentages") +
coord_flip()
pl
ggplotly(pl)
pl <- ggplot(mydata, aes(century, fill = stripes)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of stripes by century")
pl
ggplotly(pl)
pl <- ggplot(mydata, aes(type, fill = stripes)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of stripes by type")
pl
ggplotly(pl)
Stripes_P <- filter(mydata,  stripes %in% c("Stripes"))
pl <- ggplot(Stripes_P, aes(century, fill = blood)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of stripes and blood")
pl
ggplotly(pl)
Stripes_P <- filter(mydata,  stripes %in% c("Stripes"))
pl <- ggplot(Stripes_P, aes(century, fill = action)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of stripes by century")
pl
ggplotly(pl)
Stripes_P <- filter(mydata,  stripes %in% c("Stripes"))
pl <- ggplot(Stripes_P, aes(title, fill = action)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", position=position_stack(vjust=0.5), colour = "black") +
coord_flip()+
ggtitle("Presence of stripes by century")
pl
ggplotly(pl)
crown <- filter(mydata,  holofernes_crowned %in% c("Crowned"))
ggplot(crown, aes(century, fill = blood)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", vjust = 0.25, colour = "black") +
coord_flip()+
ggtitle("Distribution of Bibles historiales by century")
dt <- mydata%>%
dplyr::group_by(century, holofernes_crowned)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= century, y = n, fill = holofernes_crowned))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes crowned by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(type, holofernes_crowned)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= type, y = n, fill = holofernes_crowned))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes crowned by type of decoration") +
coord_flip()
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(action, holofernes_crowned)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= action, y = n, fill = holofernes_crowned))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes crowned by action")+
coord_flip()
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(century, sword)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= century, y = n, fill = sword))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Sword by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(country, sword)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= country, y = n,fill = sword))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Sword by Country")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(type, sword)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= type, y = n,fill = sword))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Sword by type of decoration")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(title, sword)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= title, y = n,fill = sword))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Sword by text")
pl
ggplotly(pl)
Sword <- filter(mydata,  sword %in% c("Two-hands_sword"))
dt <- Sword%>%
dplyr::group_by(title, blood)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= title, y = n,fill = blood))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Two-hands sword by text and presence of blood")
pl
dt <- mydata%>%
dplyr::group_by(century, holofernes_naked)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= century, y = n,fill = holofernes_naked))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes naked by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(country, holofernes_naked)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= country, y = n,fill = holofernes_naked))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes naked by country")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(type, holofernes_naked)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= type, y = n,fill = holofernes_naked)) +
geom_bar(stat="identity") +
geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3) +
theme(axis.text.x = element_text(angle = 90,hjust =0 )) +
ggtitle("Holofernes naked by type of decoration")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(language, holofernes_naked)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= language, y = n,fill = holofernes_naked)) +
geom_bar(stat="identity") +
geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3) +
theme(axis.text.x = element_text(angle = 90,hjust =0 )) +
ggtitle("Holofernes naked by language")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(title, holofernes_naked)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= title, y = n,fill = holofernes_naked)) +
geom_bar(stat="identity") +
geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3) +
theme(axis.text.x = element_text(angle = 90,hjust =0 )) +
ggtitle("Holofernes naked by text")+
coord_flip()
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(century, Intended_reader)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= century, y = n,fill = Intended_reader))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes naked by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(Intended_reader, blood)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= Intended_reader, y = n,fill = blood))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Holofernes naked by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(Intended_reader, action)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= Intended_reader, y = n,fill = action))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Action represented by intended reader")
pl
ggplotly(pl)
pl <- ggplot(mydata, aes(century, title)) +
geom_text(aes(label = country, color=type))
pl
ggplotly(pl)
pl <- ggplot(mydata, aes(century, title)) +
geom_text(aes(label = action, color=action))
pl
ggplotly(pl)
show_image(file.path("images", cn, top_n(mydata, avg_red, n=10)$path), ncol=5) +
posters$title[4001:4020]
show_image(file.path("images", cn, top_n(mydata, avg_blue, n=10)$path), ncol=5)
show_image(file.path("images", cn, top_n(mydata, avg_green, n=10)$path), ncol=5)
show_image(file.path("images", cn, top_n(mydata, avg_black, n=10)$path), ncol=5)
library(keras)
Sys.setenv(KMP_DUPLICATE_LIB_OK="TRUE")
resnet50 <- application_resnet50(weights = 'imagenet', include_top = TRUE)
y
library(keras)
Sys.setenv(KMP_DUPLICATE_LIB_OK="TRUE")
true
TRUE
install_tensorflow()
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(dplyr)
library(ggplot2)
library(stringi)
library(jpeg)
library(ggthemes)
library(scales)
library(maps)
library(plotly)
library(gapminder)
source(file.path("scripts", "funs.R"))
library(igraph)
theme_set(theme_minimal())
source("scripts/funs.R")
if (!require("readr"))     install.packages("readr",     repos = "https://cran.rstudio.com/")
if (!require("dplyr"))     install.packages("dplyr",     repos = "https://cran.rstudio.com/")
if (!require("ggplot2"))   install.packages("ggplot2",   repos = "https://cran.rstudio.com/")
if (!require("maps"))      install.packages("maps",      repos = "https://cran.rstudio.com/")
if (!require("mapproj"))   install.packages("mapproj",   repos = "https://cran.rstudio.com/")
if (!require("cleanNLP"))  install.packages("cleanNLP",  repos = "https://cran.rstudio.com/")
if (!require("stringi"))   install.packages("stringi",   repos = "https://cran.rstudio.com/")
if (!require("forcats"))   install.packages("forcats",   repos = "https://cran.rstudio.com/")
if (!require("ggplot2"))   install.packages("ggplot2",   repos = "https://cran.rstudio.com/")
if (!require("Hmisc"))     install.packages("Hmisc",     repos = "https://cran.rstudio.com/")
if (!require("igraph"))    install.packages("igraph",    repos = "https://cran.rstudio.com/")
if (!require("tidyr"))     install.packages("tidyr",     repos = "https://cran.rstudio.com/")
if (!require("gridExtra")) install.packages("gridExtra", repos = "https://cran.rstudio.com/")
if (!require("DescTools")) install.packages("DescTools", repos = "https://cran.rstudio.com/")
if (!require("hexbin"))    install.packages("hexbin",    repos = "https://cran.rstudio.com/")
if (!require("ggthemes"))  install.packages("ggthemes",    repos = "https://cran.rstudio.com/")
if (!require("plotly"))    install.packages("plotly",    repos = "https://cran.rstudio.com/")
if (!require("keras"))     install.packages("keras", repos = "https://cran.rstudio.com/")
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(dplyr)
library(ggplot2)
library(stringi)
library(jpeg)
library(ggthemes)
library(scales)
library(maps)
library(plotly)
library(gapminder)
source(file.path("scripts", "funs.R"))
library(igraph)
theme_set(theme_minimal())
source("scripts/funs.R")
cn <- "Judith"
head(dir(file.path("images", cn)))
mydata <- read_csv(file.path("data", sprintf("%s.csv", cn)))
mydata
count(mydata, type, sort=TRUE)
ggplot(mydata, aes(type, fill = type)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", vjust = 0.25, colour = "black") +
coord_flip()+
ggtitle("Distribution of manuscripts by type of text")
count(mydata, Intended_reader, sort=TRUE)
ggplot(mydata, aes(Intended_reader, fill = Intended_reader)) +
geom_bar() +
geom_text(aes(label = ..count..), stat = "count", vjust = 0.25, colour = "black") +
coord_flip()+
ggtitle("Distribution of manuscripts by type of text")
dt <- mydata%>%
dplyr::group_by(century, Intended_reader)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= century, y = n,fill = Intended_reader))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Intended reader by century")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(Intended_reader, blood)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= Intended_reader, y = n,fill = blood))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Presence of blood by intended reader")
pl
ggplotly(pl)
dt <- mydata%>%
dplyr::group_by(Intended_reader, action)%>%
dplyr::tally()%>%
dplyr::mutate(percent=n/sum(n))
pl <- ggplot(data = dt,aes(x= Intended_reader, y = n,fill = action))
pl <- pl + geom_bar(stat="identity")
pl <- pl + geom_text(aes(label=paste0(sprintf("%1.1f", percent*100),"%")),
position=position_stack(vjust=0.5), colour="black", size = 3)
pl <- pl  + theme(axis.text.x = element_text(angle = 90,hjust =0 ))
pl <- pl  + ggtitle("Action represented by intended reader")
pl
ggplotly(pl)
